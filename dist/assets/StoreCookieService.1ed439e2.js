class g{constructor(){if(this.simulated=typeof window.Drupal!="object",this.drupal=typeof window.Drupal=="object"?window.Drupal:{behaviors:{}},typeof window.drupalSettings=="object")this.drupalSettings={...window.drupalSettings};else{const e=document.querySelector('body > script[type="application/json"][data-drupal-selector="drupal-settings-json"]');this.drupalSettings=e!==null?JSON.parse(e.textContent):{}}this.once=typeof window.once=="function"?window.once:(e,t,s)=>s.querySelectorAll(t)}getSimulated(){return this.simulated}getDrupal(){return this.drupal}getDrupalSettings(e){return typeof this.drupalSettings[e]<"u"?this.drupalSettings[e]:this.drupalSettings}getOnce(){return this.once}}const u=new g;typeof u.updateJson=="function"&&u.updateJson();u.getDrupal();const v=u.getDrupalSettings("cookiesjsr");u.getOnce();u.getSimulated();class h{constructor(e){e=typeof e=="object"?e:{},this.config=e}get(e,t=null){if(e==="")return this.config;let s;switch(typeof this.config[e]){case"string":case"object":case"number":case"boolean":s=this.config[e];break;default:let i=this.resolve(e);s=typeof i<"u"?i:t}return t===null||s===t||typeof s==typeof t?s:t}resolve(e,t="."){return e.split(t).reduce((i,o)=>i&&i[o],this.config)}getServiceIds(){const e=this.get("services",{});let t=[];for(let s in e){let i=e[s];if(typeof i.services=="object")for(let o in i.services){let r=i.services[o];typeof r.key=="string"&&t.push(r.key)}}return t}getServiceGroups(){const e=this.get("services",{});let t={};for(let s in e){let i=e[s];typeof i.services=="object"&&(t[s]=i)}return t}}const n=new h(v);class S{constructor(){this.servicesStatus={},this.updateRequired=!1,this.receiveChangeEvents();const e=this.serviceActivationStatus();this.initialFireEvents(e)}initialFireEvents(e){this.fireEvent(e);const t=this;document.addEventListener("DOMContentLoaded",function(){t.fireEvent(e)}),window.addEventListener("load",function(){t.fireEvent(e)})}fireEvent(e){let t={bubbles:!1,detail:{services:e}};document.dispatchEvent(new CustomEvent("cookiesjsrUserConsent",t))}getCookie(){const e=n.get("config.cookie.name","cookiesjsr");let t=document.cookie.match("(^|[^;]+)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():"{}"}setCookie(e){if(typeof e!="object")return!1;let t=encodeURIComponent(JSON.stringify(e)),i=n.get("config.cookie.name","cookiesjsr")+"="+t,o=new Date,r=o.getTime();const c=n.get("config.cookie.expires",2592e6);let a=r+parseInt(c,10);o.setTime(a);const d=n.get("config.cookie.secure",!0)?"; Secure=true":"";let p=n.get("config.cookie.sameSite","None");p="; SameSite="+p;let l=n.get("config.cookie.domain","");l=l.length?" domain="+l+";":"",document.cookie=i+"; expires="+o.toUTCString()+d+p+"; path=/"+l+";"}getServices(){let e=this.getCookie();return JSON.parse(decodeURIComponent(e))}setServices(e){this.setCookie(e),this.fireEvent(e),this.sendCallback(e),this.serviceActivationStatus()}sendCallback(e){let t=n.get("config.callback.method","GET");t=t.toUpperCase();const s=n.get("config.callback.url","");if(s.length){const i=n.get("config.callback.headers",[]),o=t==="GET"?null:{method:t,headers:i,body:JSON.stringify(e)},r=t==="GET"?"?"+new URLSearchParams(e):"";fetch(s+r,o).then(c=>c.json()).then(c=>{try{const a={bubbles:!1,detail:c};document.dispatchEvent(new CustomEvent("cookiesjsrCallbackResponse",a))}catch(a){console.error("Failed to dispatch event cookiesjsrCallbackResponse",a)}}).catch(c=>{console.error(`Error: Callback ${s} after setting cookies user consent failed.`,c)})}}receiveChangeEvents(){const e=this;document.addEventListener("cookiesjsrSetService",function(t){const s=t.detail;let i=e.getServices();if(typeof s.all=="boolean")for(let o in e.servicesStatus)i[o]=s.all;if(typeof s.groups=="object"){const o=n.get("services",{});for(let r in s.groups){let c=s.groups[r];if(typeof o[r]=="object"&&typeof o[r].services=="object")for(let a in o[r].services){let d=o[r].services[a];i[d.key]=c}}}if(typeof s.services<"u")for(let o in e.servicesStatus)i[o]=typeof s.services[o]<"u"?s.services[o]:i[o];e.setServices(i)})}serviceActivationStatus(){this.updateRequired=!1;let e=this.getServices();const t=n.getServiceIds();for(let s in t){let i=t[s];typeof e[i]>"u"?(this.servicesStatus[i]=!1,this.updateRequired=!0):this.servicesStatus[i]=e[i]}return this.servicesStatus}isUpdateRequired(){return this.updateRequired}getServicesStatus(){return{...this.servicesStatus}}}const m=new S;export{n as C,m as S};
